<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>誰やねん</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Yusei+Magic&display=swap" rel="stylesheet">
<style>
  :root{
    --page-bg:#ffffff;
    --panel-bg:#ffffff;
    --border:#e5e7eb;
    --chip-bg:#f8fafc;
    --chip-bd:#cbd5e1;
    --gap:12px;
    --control-col:180px;
    --exclude-col:180px;
    /* チームカラー */
    --EARTH-JETS:#065f46;
    --赤坂ドリブンズ:#a3e635;
    --EX風林火山:#8B5E3C;
    --KADOKAWAサクラナイツ:#f472b6;
    --KONAMI麻雀格闘倶楽部:#ef4444;
    --渋谷ABEMAS:#9ca3af;
    --セガサミーフェニックス:#fb923c;
    --TEAM-RAIDEN-雷電:#facc15;
    --BEAST-X:#1e3a8a;
    --U-NEXT-Pirates:#60a5fa;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:'Noto Sans JP',system-ui,sans-serif;background:var(--page-bg);color:#111}
  .wrap{max-width:1700px;margin:14px auto;padding:0 12px}
  .title{font-family:'Yusei Magic','Noto Sans JP',sans-serif;font-size:40px;text-align:center;margin:0 0 10px}
  /* Layout: Left | Control | Mid | ExcludeBtn | Right */
  .grid{
    display:grid;
    grid-template-columns: 1fr var(--control-col) 1fr var(--exclude-col) 1fr;
    gap:var(--gap);
    align-items:start;
  }
  .panel{
    background:var(--panel-bg);
    border:2px solid var(--border);
    border-radius:12px;
    padding:10px;
    min-height:420px;
  }
  .panel h2{margin:0 0 8px;font-size:15px;font-weight:800}
  .group{border-radius:10px;padding:8px;margin-bottom:8px}
  .team-pill{display:inline-block;padding:5px 10px;border-radius:999px;font-weight:800;font-size:13px;color:#fff}
  .list{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:8px}
  .chip{display:inline-flex;align-items:center;justify-content:center;padding:8px 10px;border-radius:999px;border:2px solid var(--chip-bd);font-size:15px;font-weight:600;background:var(--chip-bg);cursor:pointer;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .chip.male{background:#dbeafe}
  .chip.female{background:#ffe4e6}
  .chip.highlight{background:#fef9c3 !important}
  .empty{font-size:12px;color:#64748b}
  /* Control columns */
  .centerCol, .excludeCol{
    display:flex; flex-direction:column; align-items:center; gap:10px; padding-top:6px;
  }
  .btn{
    border:2px solid #111; background:#fff; padding:8px 14px; border-radius:10px; cursor:pointer; font-weight:800
  }
  .btn.active{ background:#111; color:#fff; }
  .note{font-size:12px;color:#6b7280;text-align:center}
  /* Controls under panels */
  .controls{margin:12px 0 0;display:flex;flex-direction:column;gap:8px;align-items:flex-start}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .label-reset{font-size:12px;font-weight:700;border:2px solid #111;background:#fff;padding:6px 10px;border-radius:999px;cursor:pointer}
  .tbtn{border:none;background:transparent;cursor:pointer;padding:0;margin:0}
  .tbtn.active .team-pill{outline:3px solid rgba(0,0,0,.15)}
  @media(max-width:1200px){
    .grid{grid-template-columns:1fr;gap:10px}
    .list{grid-template-columns:repeat(2,1fr)}
  }
</style>
</head>
<body>
<div class="wrap">
  <h1 class="title">誰やねん</h1>

  <div class="grid">
    <!-- Left -->
    <section class="panel">
      <h2>・お前やねん</h2>
      <div id="left"></div>
      <div id="leftEmpty" class="empty">左側にはまだ何も表示されていません</div>
    </section>

    <!-- Control between Left and Mid -->
    <div class="centerCol">
      <button id="swapBtn" class="btn">左右を入れ替える</button>
      <button id="excludeMaleBtn" class="btn">男を除外</button>
      <button id="excludeFemaleBtn" class="btn">女を除外</button>
      <div class="note">※ 除外はトグル。もう一度押すと元に戻ります</div>
    </div>

    <!-- Mid -->
    <section class="panel">
      <h2>・お前じゃないねん</h2>
      <div id="mid"></div>
      <div id="midEmpty" class="empty">中央にはまだ何もありません</div>
    </section>

    <!-- Column between Mid and Right -->
    <div class="excludeCol">
      <button id="excludeAllMid" class="btn">完全に除外する</button>
      <div class="note">※ 中央にいる全員 → 右へ</div>
    </div>

    <!-- Right (Excluded) -->
    <section class="panel">
      <h2>・完全除外</h2>
      <div id="right"></div>
      <div id="rightEmpty" class="empty">完全除外にはまだ何もありません</div>
    </section>
  </div>

  <!-- Bottom controls -->
  <div class="controls">
    <div class="row">
      <button id="resetAll" class="label-reset">全てリセット</button>
      <button id="selectAllTeams" class="label-reset">全てのチームを選択</button>
    </div>
    <div class="row" id="teamsRow"></div>
  </div>
</div>

<script>
// ------------------ Data ------------------
const DATA=[
{id:"ishii",label:"石井一馬",team:"EARTH JETS",gender:"男"},
{id:"miura",label:"三浦智博",team:"EARTH JETS",gender:"男"},
{id:"hiro",label:"HIRO柴田",team:"EARTH JETS",gender:"男"},
{id:"aikawa",label:"逢川恵夢",team:"EARTH JETS",gender:"女"},
{id:"sonoda",label:"園田賢",team:"赤坂ドリブンズ",gender:"男"},
{id:"suzuki_ta",label:"鈴木たろう",team:"赤坂ドリブンズ",gender:"男"},
{id:"watanabe",label:"渡辺太",team:"赤坂ドリブンズ",gender:"男"},
{id:"asami",label:"浅見真紀",team:"赤坂ドリブンズ",gender:"女"},
{id:"katsumata",label:"勝又健志",team:"EX風林火山",gender:"男"},
{id:"nagai",label:"永井孝典",team:"EX風林火山",gender:"男"},
{id:"uchikawa",label:"内川幸太郎",team:"EX風林火山",gender:"男"},
{id:"nikaido_a",label:"二階堂亜樹",team:"EX風林火山",gender:"女"},
{id:"hori",label:"堀慎吾",team:"KADOKAWAサクラナイツ",gender:"男"},
{id:"shibukawa",label:"渋川難波",team:"KADOKAWAサクラナイツ",gender:"男"},
{id:"akutsu",label:"阿久津翔太",team:"KADOKAWAサクラナイツ",gender:"男"},
{id:"okada_2",label:"岡田紗佳",team:"KADOKAWAサクラナイツ",gender:"女"},
{id:"sasaki_h",label:"佐々木寿人",team:"KONAMI麻雀格闘倶楽部",gender:"男"},
{id:"takizawa",label:"滝沢和典",team:"KONAMI麻雀格闘倶楽部",gender:"男"},
{id:"takamiya",label:"高宮まり",team:"KONAMI麻雀格闘倶楽部",gender:"女"},
{id:"date_arisa",label:"伊達朱里紗",team:"KONAMI麻雀格闘倶楽部",gender:"女"},
{id:"oi",label:"多井隆晴",team:"渋谷ABEMAS",gender:"男"},
{id:"shiratori",label:"白鳥翔",team:"渋谷ABEMAS",gender:"男"},
{id:"matsumoto",label:"松本吉弘",team:"渋谷ABEMAS",gender:"男"},
{id:"hyuga",label:"日向藍子",team:"渋谷ABEMAS",gender:"女"},
{id:"daigo",label:"醍醐大",team:"セガサミーフェニックス",gender:"男"},
{id:"takeuchi",label:"竹内元太",team:"セガサミーフェニックス",gender:"男"},
{id:"asai",label:"浅井堂岐",team:"セガサミーフェニックス",gender:"男"},
{id:"chinamori_2",label:"茅森早香",team:"セガサミーフェニックス",gender:"女"},
{id:"hagiwara",label:"萩原聖人",team:"TEAM RAIDEN/雷電",gender:"男"},
{id:"setokuma",label:"瀬戸熊直樹",team:"TEAM RAIDEN/雷電",gender:"男"},
{id:"honda",label:"本田朋広",team:"TEAM RAIDEN/雷電",gender:"男"},
{id:"kurosawa",label:"黒沢咲",team:"TEAM RAIDEN/雷電",gender:"女"},
{id:"suzuki_d",label:"鈴木大介",team:"BEAST X",gender:"男"},
{id:"shimoishi",label:"下石戟",team:"BEAST X",gender:"男"},
{id:"tojyo",label:"東城りお",team:"BEAST X",gender:"女"},
{id:"nakata",label:"中田花奈",team:"BEAST X",gender:"女"},
{id:"kobayashi_t",label:"小林剛",team:"U-NEXT Pirates",gender:"男"},
{id:"suzuki_y",label:"鈴木優",team:"U-NEXT Pirates",gender:"男"},
{id:"nakabayashi",label:"仲林圭",team:"U-NEXT Pirates",gender:"男"},
{id:"mizuhara_2",label:"瑞原明奈",team:"U-NEXT Pirates",gender:"女"}
];

// 薄黄色ハイライト（東城りおは含めない）
const HIGHLIGHT_SET=new Set(["石井一馬","三浦智博","HIRO柴田","逢川恵夢","永井孝典","阿久津翔太","下石戟"]);

// 表示順固定
const teams=["EARTH JETS","赤坂ドリブンズ","EX風林火山","KADOKAWAサクラナイツ","KONAMI麻雀格闘倶楽部","渋谷ABEMAS","セガサミーフェニックス","TEAM RAIDEN/雷電","BEAST X","U-NEXT Pirates"];

function teamKey(name){return name.replaceAll('/','-').replaceAll(' ','-');}

// ---- State ----
// locationMap: id -> 'left' | 'mid' | 'right'  初期は全員 'left'
const locationMap = new Map(); DATA.forEach(p=>locationMap.set(p.id,'left'));
// prevMap: 直前の位置
const prevMap = new Map();
// 左に表示するチーム
const leftTeams = new Set();

// 除外トグルで移動させた人たち（戻す対象）
let toggledMaleSet = new Set();
let toggledFemaleSet = new Set();
let maleActive = false;
let femaleActive = false;

// DOM
const leftRoot=document.getElementById('left');
const midRoot=document.getElementById('mid');
const rightRoot=document.getElementById('right');
const leftEmpty=document.getElementById('leftEmpty');
const midEmpty=document.getElementById('midEmpty');
const rightEmpty=document.getElementById('rightEmpty');

function moveTo(id, newLoc){
  const cur = locationMap.get(id) || 'left';
  if (cur === newLoc) return;
  prevMap.set(id, cur);
  locationMap.set(id, newLoc);
}

function revertOne(id){
  const cur = locationMap.get(id) || 'left';
  const prev = prevMap.get(id);
  if (!prev){
    // 既定の往復：left<->mid, right->mid
    if (cur === 'left'){ prevMap.set(id,'left'); locationMap.set(id,'mid'); }
    else if (cur === 'mid'){ prevMap.set(id,'mid'); locationMap.set(id,'left'); }
    else if (cur === 'right'){ prevMap.set(id,'right'); locationMap.set(id,'mid'); }
  } else {
    // 現在と直前を入れ替える
    locationMap.set(id, prev);
    prevMap.set(id, cur);
  }
}

function groupByTeam(items){
  const map=new Map(); teams.forEach(t=>map.set(t,[]));
  items.forEach(it=>{ if(!map.has(it.team)) map.set(it.team,[]); map.get(it.team).push(it); });
  return map;
}

function renderPanel(root, items){
  root.innerHTML='';
  const map=groupByTeam(items);
  for (const [team, arr] of map.entries()){
    if (arr.length===0) continue;
    const key=teamKey(team);
    const g=document.createElement('div'); g.className='group';
    g.style.background=`color-mix(in hsl, var(--${key}) 16%, white)`;
    const pill=document.createElement('span'); pill.className='team-pill'; pill.textContent=team;
    pill.style.background=`var(--${key})`;
    const head=document.createElement('div'); head.appendChild(pill);
    const list=document.createElement('div'); list.className='list';
    arr.forEach(p=>{
      const chip=document.createElement('div');
      chip.className='chip ' + (p.gender==='男' ? 'male' : 'female');
      if (HIGHLIGHT_SET.has(p.label)) chip.classList.add('highlight');
      chip.textContent=p.label;
      chip.title=`${p.label}（${p.team}／${p.gender}）\nクリックで直前の位置に戻す`;
      chip.addEventListener('click',()=>{ revertOne(p.id); render(); });
      list.appendChild(chip);
    });
    g.appendChild(head);
    g.appendChild(list);
    root.appendChild(g);
  }
}

function itemsAt(loc){ return DATA.filter(p=> (locationMap.get(p.id) || 'left') === loc); }
function visibleLeftItems(){ return DATA.filter(p=> (locationMap.get(p.id) || 'left') === 'left' && leftTeams.has(p.team)); }

function render(){
  const leftItems=visibleLeftItems();
  const midItems=itemsAt('mid');
  const rightItems=itemsAt('right');

  renderPanel(leftRoot, leftItems);
  renderPanel(midRoot, midItems);
  renderPanel(rightRoot, rightItems);

  leftEmpty.style.display = leftItems.length ? 'none' : 'block';
  midEmpty.style.display  = midItems.length ? 'none' : 'block';
  rightEmpty.style.display= rightItems.length ? 'none' : 'block';
}

// ---- Bottom team buttons ----
const teamsRow=document.getElementById('teamsRow'); const teamButtons={};
teams.forEach(team=>{
  const key=teamKey(team);
  const btn=document.createElement('button'); btn.className='tbtn'; btn.dataset.team=team;
  const pill=document.createElement('span'); pill.className='team-pill'; pill.textContent=team;
  pill.style.background=`var(--${key})`; pill.style.color='#fff';
  btn.appendChild(pill);
  btn.addEventListener('click',()=>{
    if (leftTeams.has(team)){ leftTeams.delete(team); btn.classList.remove('active'); }
    else { leftTeams.add(team); btn.classList.add('active'); }
    render();
  });
  teamButtons[team]=btn;
  teamsRow.appendChild(btn);
});

// ---- Buttons ----
// 全てリセット：位置/直前/チーム/トグルを初期化
document.getElementById('resetAll').addEventListener('click',()=>{
  leftTeams.clear();
  locationMap.clear(); prevMap.clear();
  DATA.forEach(p=>locationMap.set(p.id,'left'));
  Object.values(teamButtons).forEach(b=>b.classList.remove('active'));
  maleActive=false; femaleActive=false;
  toggledMaleSet=new Set(); toggledFemaleSet=new Set();
  document.getElementById('excludeMaleBtn').classList.remove('active');
  document.getElementById('excludeFemaleBtn').classList.remove('active');
  render();
});

// 全チームを左に表示（位置は変えない）
document.getElementById('selectAllTeams').addEventListener('click',()=>{
  teams.forEach(t=>leftTeams.add(t));
  Object.values(teamButtons).forEach(b=>b.classList.add('active'));
  render();
});

// 左↔中央 入れ替え（見えている左のみ↔中央すべて）
document.getElementById('swapBtn').addEventListener('click',()=>{
  const leftNow=visibleLeftItems();
  const midNow=itemsAt('mid');
  leftNow.forEach(p=>moveTo(p.id,'mid'));
  midNow.forEach(p=>moveTo(p.id,'left'));
  render();
});

// 男を除外（トグル）
document.getElementById('excludeMaleBtn').addEventListener('click', (e)=>{
  const btn=e.currentTarget;
  if (!maleActive){
    // 左に見えている男だけ中央へ
    toggledMaleSet = new Set(visibleLeftItems().filter(p=>p.gender==='男').map(p=>p.id));
    toggledMaleSet.forEach(id=>moveTo(id,'mid'));
    maleActive=true; btn.classList.add('active');
  } else {
    // 直前に除外した男を戻す（今も中央にいる分だけ）
    const ids=[...toggledMaleSet];
    ids.forEach(id=>{ if ((locationMap.get(id) || 'left') === 'mid') moveTo(id,'left'); });
    maleActive=false; btn.classList.remove('active');
    toggledMaleSet=new Set();
  }
  render();
});

// 女を除外（トグル）
document.getElementById('excludeFemaleBtn').addEventListener('click', (e)=>{
  const btn=e.currentTarget;
  if (!femaleActive){
    toggledFemaleSet = new Set(visibleLeftItems().filter(p=>p.gender==='女').map(p=>p.id));
    toggledFemaleSet.forEach(id=>moveTo(id,'mid'));
    femaleActive=true; btn.classList.add('active');
  } else {
    const ids=[...toggledFemaleSet];
    ids.forEach(id=>{ if ((locationMap.get(id) || 'left') === 'mid') moveTo(id,'left'); });
    femaleActive=false; btn.classList.remove('active');
    toggledFemaleSet=new Set();
  }
  render();
});

// 完全に除外する：中央 → 右（全員）
document.getElementById('excludeAllMid').addEventListener('click',()=>{
  itemsAt('mid').forEach(p=>moveTo(p.id,'right'));
  render();
});

// 初期描画
render();
</script>
</body>
</html>
