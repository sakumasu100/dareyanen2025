<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>誰やねん</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Yusei+Magic&display=swap" rel="stylesheet">
<style>
  :root{
    --page-bg:#ffffff;
    --panel-bg:#ffffff;
    --border:#e5e7eb;
    --chip-bg:#f8fafc;
    --chip-bd:#cbd5e1;
    --gap:10px;
    --control-col:175px;
    --exclude-col:175px;
    /* チームカラー */
    --EARTH-JETS:#065f46;           /* 深緑 */
    --赤坂ドリブンズ:#a3e635;      /* 黄緑 */
    --EX風林火山:#8B5E3C;          /* 茶色 */
    --KADOKAWAサクラナイツ:#f472b6; /* ピンク */
    --KONAMI麻雀格闘倶楽部:#ef4444; /* 赤 */
    --渋谷ABEMAS:#9ca3af;           /* 灰 */
    --セガサミーフェニックス:#fb923c; /* オレンジ */
    --TEAM-RAIDEN-雷電:#facc15;     /* 黄 */
    --BEAST-X:#1e3a8a;              /* 紺 */
    --U-NEXT-Pirates:#60a5fa;       /* 空色 */
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:'Noto Sans JP',system-ui,sans-serif;background:var(--page-bg);color:#111; overflow:hidden;}
  .wrap{max-width:1920px;margin:8px auto;padding:0 12px;height:calc(100vh - 16px);display:flex;flex-direction:column;gap:8px}
  .title{font-family:'Yusei Magic','Noto Sans JP',sans-serif;font-size:40px;text-align:center;margin:0}
  /* Layout: Left | Control | Mid | ExcludeBtn | Right */
  .grid{
    display:grid;
    grid-template-columns: 1fr var(--control-col) 1fr var(--exclude-col) 1fr;
    gap:var(--gap);
    align-items:start;
    flex:1 1 auto;
    min-height:0; /* allow children to shrink */
  }
  .panel{
    background:var(--panel-bg);
    border:2px solid var(--border);
    border-radius:10px;
    padding:8px;
    height:100%;
    overflow:auto;
  }
  .panel h2{margin:0 0 6px;font-size:16px;font-weight:800}
  /* 1段で「チーム名 + 最大4人」を横並びにする行 */
  .groupRow{
    display:grid;
    grid-template-columns:110px repeat(4, 1fr);
    align-items:center;
    gap:6px;
    padding:4px 6px;
    border-radius:8px;
    margin-bottom:4px;
  }
  .team-pill{
    display:inline-block;
    min-width:110px;
    text-align:center;
    padding:4px 6px;
    border-radius:999px;
    font-weight:800;
    font-size:12px;
    color:#fff;
    white-space:nowrap;
    cursor:pointer;
  }
  .chip{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    padding:6px 8px;
    border-radius:999px;
    border:2px solid var(--chip-bd);
    background:var(--chip-bg);
    font-size:14px;
    font-weight:700;
    cursor:pointer;
    min-width:0;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .chip.male{background:#dbeafe}
  .chip.female{background:#ffe4e6}
  .chip.highlight{background:#fef9c3 !important}
  .empty{font-size:12px;color:#64748b;padding:0 6px}
  /* Control columns */
  .centerCol, .excludeCol{
    display:flex; flex-direction:column; align-items:stretch; gap:10px; padding-top:4px; height:100%;
  }
  .btn{
    border:2px solid #111; background:#fff; padding:10px 12px; border-radius:10px; cursor:pointer; font-weight:800; font-size:14px;
  }
  .btn.active{ background:#111; color:#fff; }
  .note{font-size:12px;color:#6b7280;text-align:center}
  /* Bottom controls */
  .controls{display:flex;justify-content:center}
  .reset-big{font-size:16px;font-weight:900;border:3px solid #111;background:#fff;padding:10px 18px;border-radius:999px;cursor:pointer}
  @media(max-width:1400px){
    .title{font-size:34px}
    .btn{font-size:13px;padding:9px 10px}
  }
</style>
</head>
<body>
<div class="wrap">
  <h1 class="title">誰やねん</h1>

  <div class="grid">
    <!-- Left -->
    <section class="panel">
      <h2>・お前やねん</h2>
      <div id="left"></div>
      <div id="leftEmpty" class="empty">左側にはまだ何も表示されていません</div>
    </section>

    <!-- Control between Left and Mid -->
    <div class="centerCol">
      <button id="swapBtn" class="btn">左右を入れ替える</button>
      <button id="excludeMaleBtn" class="btn">男を除外（トグル）</button>
      <button id="excludeFemaleBtn" class="btn">女を除外（トグル）</button>
      <div class="note">※ 除外ボタンは、左に“見えている”該当性別だけ中央へ移動／再押下で戻す</div>
    </div>

    <!-- Mid -->
    <section class="panel">
      <h2>・お前じゃないねん</h2>
      <div id="mid"></div>
      <div id="midEmpty" class="empty">中央にはまだ何もありません</div>
    </section>

    <!-- Column between Mid and Right -->
    <div class="excludeCol">
      <button id="excludeAllMid" class="btn">完全に除外する</button>
      <div class="note">※ 中央にいる全員 → 右へ</div>
    </div>

    <!-- Right (Excluded) -->
    <section class="panel">
      <h2>・完全除外</h2>
      <div id="right"></div>
      <div id="rightEmpty" class="empty">完全除外にはまだ何もありません</div>
    </section>
  </div>

  <!-- Bottom control (Reset only) -->
  <div class="controls">
    <button id="resetAll" class="reset-big">全てリセット</button>
  </div>
</div>

<script>
// ------------------ Data ------------------
const DATA=[
{id:"ishii",label:"石井一馬",team:"EARTH JETS",short:"EARTH JETS",gender:"男"},
{id:"miura",label:"三浦智博",team:"EARTH JETS",short:"EARTH JETS",gender:"男"},
{id:"hiro",label:"HIRO柴田",team:"EARTH JETS",short:"EARTH JETS",gender:"男"},
{id:"aikawa",label:"逢川恵夢",team:"EARTH JETS",short:"EARTH JETS",gender:"女"},
{id:"sonoda",label:"園田賢",team:"赤坂ドリブンズ",short:"赤坂ドリブンズ",gender:"男"},
{id:"suzuki_ta",label:"鈴木たろう",team:"赤坂ドリブンズ",short:"赤坂ドリブンズ",gender:"男"},
{id:"watanabe",label:"渡辺太",team:"赤坂ドリブンズ",short:"赤坂ドリブンズ",gender:"男"},
{id:"asami",label:"浅見真紀",team:"赤坂ドリブンズ",short:"赤坂ドリブンズ",gender:"女"},
{id:"katsumata",label:"勝又健志",team:"EX風林火山",short:"EX風林火山",gender:"男"},
{id:"nagai",label:"永井孝典",team:"EX風林火山",short:"EX風林火山",gender:"男"},
{id:"uchikawa",label:"内川幸太郎",team:"EX風林火山",short:"EX風林火山",gender:"男"},
{id:"nikaido_a",label:"二階堂亜樹",team:"EX風林火山",short:"EX風林火山",gender:"女"},
{id:"hori",label:"堀慎吾",team:"KADOKAWAサクラナイツ",short:"サクラナイツ",gender:"男"},
{id:"shibukawa",label:"渋川難波",team:"KADOKAWAサクラナイツ",short:"サクラナイツ",gender:"男"},
{id:"akutsu",label:"阿久津翔太",team:"KADOKAWAサクラナイツ",short:"サクラナイツ",gender:"男"},
{id:"okada_2",label:"岡田紗佳",team:"KADOKAWAサクラナイツ",short:"サクラナイツ",gender:"女"},
{id:"sasaki_h",label:"佐々木寿人",team:"KONAMI麻雀格闘倶楽部",short:"KONAMI",gender:"男"},
{id:"takizawa",label:"滝沢和典",team:"KONAMI麻雀格闘倶楽部",short:"KONAMI",gender:"男"},
{id:"takamiya",label:"高宮まり",team:"KONAMI麻雀格闘倶楽部",short:"KONAMI",gender:"女"},
{id:"date_arisa",label:"伊達朱里紗",team:"KONAMI麻雀格闘倶楽部",short:"KONAMI",gender:"女"},
{id:"oi",label:"多井隆晴",team:"渋谷ABEMAS",short:"ABEMAS",gender:"男"},
{id:"shiratori",label:"白鳥翔",team:"渋谷ABEMAS",short:"ABEMAS",gender:"男"},
{id:"matsumoto",label:"松本吉弘",team:"渋谷ABEMAS",short:"ABEMAS",gender:"男"},
{id:"hyuga",label:"日向藍子",team:"渋谷ABEMAS",short:"ABEMAS",gender:"女"},
{id:"daigo",label:"醍醐大",team:"セガサミーフェニックス",short:"セガサミー",gender:"男"},
{id:"takeuchi",label:"竹内元太",team:"セガサミーフェニックス",short:"セガサミー",gender:"男"},
{id:"asai",label:"浅井堂岐",team:"セガサミーフェニックス",short:"セガサミー",gender:"男"},
{id:"chinamori_2",label:"茅森早香",team:"セガサミーフェニックス",short:"セガサミー",gender:"女"},
{id:"hagiwara",label:"萩原聖人",team:"TEAM RAIDEN/雷電",short:"雷電",gender:"男"},
{id:"setokuma",label:"瀬戸熊直樹",team:"TEAM RAIDEN/雷電",short:"雷電",gender:"男"},
{id:"honda",label:"本田朋広",team:"TEAM RAIDEN/雷電",short:"雷電",gender:"男"},
{id:"kurosawa",label:"黒沢咲",team:"TEAM RAIDEN/雷電",short:"雷電",gender:"女"},
{id:"suzuki_d",label:"鈴木大介",team:"BEAST X",short:"BEAST X",gender:"男"},
{id:"shimoishi",label:"下石戟",team:"BEAST X",short:"BEAST X",gender:"男"},
{id:"tojyo",label:"東城りお",team:"BEAST X",short:"BEAST X",gender:"女"},
{id:"nakata",label:"中田花奈",team:"BEAST X",short:"BEAST X",gender:"女"},
{id:"kobayashi_t",label:"小林剛",team:"U-NEXT Pirates",short:"Pirates",gender:"男"},
{id:"suzuki_y",label:"鈴木優",team:"U-NEXT Pirates",short:"Pirates",gender:"男"},
{id:"nakabayashi",label:"仲林圭",team:"U-NEXT Pirates",short:"Pirates",gender:"男"},
{id:"mizuhara_2",label:"瑞原明奈",team:"U-NEXT Pirates",short:"Pirates",gender:"女"}
];

const HIGHLIGHT_SET=new Set(["石井一馬","三浦智博","HIRO柴田","逢川恵夢","永井孝典","阿久津翔太","下石戟"]);
const teams=["EARTH JETS","赤坂ドリブンズ","EX風林火山","KADOKAWAサクラナイツ","KONAMI麻雀格闘倶楽部","渋谷ABEMAS","セガサミーフェニックス","TEAM RAIDEN/雷電","BEAST X","U-NEXT Pirates"];

// ---- State ----
// 初期状態：全員 left（全チーム表示）。下のチーム選択は廃止。
const locationMap = new Map(); DATA.forEach(p=>locationMap.set(p.id,'left'));
const prevMap = new Map();

// Exclude toggles
let toggledMaleSet=new Set(), toggledFemaleSet=new Set();
let maleActive=false, femaleActive=false;

// DOM
const leftRoot=document.getElementById('left');
const midRoot=document.getElementById('mid');
const rightRoot=document.getElementById('right');
const leftEmpty=document.getElementById('leftEmpty');
const midEmpty=document.getElementById('midEmpty');
const rightEmpty=document.getElementById('rightEmpty');

function teamKey(name){return name.replaceAll('/','-').replaceAll(' ','-');}

function moveTo(id,newLoc){
  const cur=locationMap.get(id)||'left';
  if(cur===newLoc) return;
  prevMap.set(id,cur);
  locationMap.set(id,newLoc);
}

function revertOne(id){
  const cur=locationMap.get(id)||'left';
  // 完全除外にいる名前を押したら左へ
  if(cur==='right'){
    prevMap.set(id,'right');
    locationMap.set(id,'left');
    return;
  }
  const prev=prevMap.get(id);
  if(!prev){
    if(cur==='left'){ prevMap.set(id,'left'); locationMap.set(id,'mid'); }
    else if(cur==='mid'){ prevMap.set(id,'mid'); locationMap.set(id,'left'); }
  }else{
    locationMap.set(id, prev);
    prevMap.set(id, cur);
  }
}

function groupByTeam(items){
  const map=new Map();
  teams.forEach(t=>map.set(t,[]));
  items.forEach(it=>{ if(!map.has(it.team)) map.set(it.team,[]); map.get(it.team).push(it); });
  return map;
}

// 1段で「短縮チーム名 + 最大4人」
// context: 'left' | 'mid' | 'right'（pillクリック時の移動先決定に使う）
function renderPanelRow(root,items,context){
  root.innerHTML='';
  const map=groupByTeam(items);
  for(const [team,arr] of map.entries()){
    if(arr.length===0) continue;
    const key=teamKey(team);
    const row=document.createElement('div');
    row.className='groupRow';
    row.style.background=`color-mix(in hsl, var(--${key}) 14%, white)`;

    // 短縮名 pill（クリックで4人一括移動）
    const pill=document.createElement('span');
    pill.className='team-pill';
    pill.textContent=arr[0].short;
    pill.style.background=`var(--${key})`;
    pill.title = (context==='left') ? 'このチームの4人を中央へ'
               : (context==='mid') ? 'このチームの4人を左へ'
               : 'このチームの4人を左へ';
    pill.addEventListener('click',()=>{
      if(context==='left'){
        arr.forEach(p=>moveTo(p.id,'mid'));
      }else if(context==='mid'){
        arr.forEach(p=>moveTo(p.id,'left'));
      }else if(context==='right'){
        arr.forEach(p=>moveTo(p.id,'left'));
      }
      render();
    });
    row.appendChild(pill);

    // up to 4 chips
    for(let i=0;i<4;i++){
      const p=arr[i];
      const cell=document.createElement('div');
      if(p){
        const chip=document.createElement('div');
        chip.className='chip ' + (p.gender==='男' ? 'male' : 'female');
        if(HIGHLIGHT_SET.has(p.label)) chip.classList.add('highlight');
        chip.textContent=p.label;
        chip.title=`${p.label}（${p.team}／${p.gender}）\nクリックで直前の位置に戻す`;
        chip.addEventListener('click',()=>{ revertOne(p.id); render(); });
        cell.appendChild(chip);
      }else{
        cell.style.minHeight='1px';
      }
      row.appendChild(cell);
    }
    root.appendChild(row);
  }
}

function itemsAt(loc){ return DATA.filter(p => (locationMap.get(p.id)||'left')===loc); }
function visibleLeftItems(){ return itemsAt('left'); } // ← 全チーム常に表示

function render(){
  const leftItems=visibleLeftItems();
  const midItems=itemsAt('mid');
  const rightItems=itemsAt('right');

  renderPanelRow(leftRoot,leftItems,'left');
  renderPanelRow(midRoot,midItems,'mid');
  renderPanelRow(rightRoot,rightItems,'right');

  leftEmpty.style.display = leftItems.length ? 'none' : 'block';
  midEmpty.style.display  = midItems.length ? 'none' : 'block';
  rightEmpty.style.display= rightItems.length ? 'none' : 'block';
}

// ---- Buttons ----
// 全てリセット：全員を左／トグル解除
document.getElementById('resetAll').addEventListener('click',()=>{
  locationMap.clear(); prevMap.clear();
  DATA.forEach(p=>locationMap.set(p.id,'left'));
  // exclude toggles reset
  maleActive=false; femaleActive=false;
  toggledMaleSet=new Set(); toggledFemaleSet=new Set();
  document.getElementById('excludeMaleBtn').classList.remove('active');
  document.getElementById('excludeFemaleBtn').classList.remove('active');
  render();
});

// 左↔中央 入れ替え（左にいる全員 ↔ 中央の全員）
document.getElementById('swapBtn').addEventListener('click',()=>{
  const leftNow=itemsAt('left');
  const midNow=itemsAt('mid');
  leftNow.forEach(p=>moveTo(p.id,'mid'));
  midNow.forEach(p=>moveTo(p.id,'left'));
  render();
});

// 男を除外（トグル）：左にいる男→中央／再押下で中央に残る該当者を左へ戻す
document.getElementById('excludeMaleBtn').addEventListener('click',(e)=>{
  const btn=e.currentTarget;
  if(!maleActive){
    toggledMaleSet=new Set(itemsAt('left').filter(p=>p.gender==='男').map(p=>p.id));
    toggledMaleSet.forEach(id=>moveTo(id,'mid'));
    maleActive=true; btn.classList.add('active');
  }else{
    const ids=[...toggledMaleSet];
    ids.forEach(id=>{ if((locationMap.get(id)||'left')==='mid') moveTo(id,'left'); });
    maleActive=false; btn.classList.remove('active');
    toggledMaleSet=new Set();
  }
  render();
});

// 女を除外（トグル）
document.getElementById('excludeFemaleBtn').addEventListener('click',(e)=>{
  const btn=e.currentTarget;
  if(!femaleActive){
    toggledFemaleSet=new Set(itemsAt('left').filter(p=>p.gender==='女').map(p=>p.id));
    toggledFemaleSet.forEach(id=>moveTo(id,'mid'));
    femaleActive=true; btn.classList.add('active');
  }else{
    const ids=[...toggledFemaleSet];
    ids.forEach(id=>{ if((locationMap.get(id)||'left')==='mid') moveTo(id,'left'); });
    femaleActive=false; btn.classList.remove('active');
    toggledFemaleSet=new Set();
  }
  render();
});

// 完全に除外する：中央 → 右（全員）
document.getElementById('excludeAllMid').addEventListener('click',()=>{
  itemsAt('mid').forEach(p=>moveTo(p.id,'right'));
  render();
});

// 初期描画
render();
</script>
</body>
</html>
